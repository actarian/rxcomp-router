/**
 * @license rxcomp-router v1.0.0-beta.12
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function h(t){return n.Observable.create((function(e){var i,r;try{var o=t();n.isObservable(o)?i=o.subscribe((function(t){e.next(t),e.complete()})):(r=o)instanceof Promise||"object"==typeof r&&"then"in r&&"function"==typeof r.then?o.then((function(t){e.next(t),e.complete()})):"boolean"==typeof o||Array.isArray(o)?(e.next(o),e.complete()):e.error(new Error("invalid value"))}catch(t){e.error(t)}return function(){i&&i.unsubscribe()}}))}var p=function(){function t(t,e){void 0===e&&(e={}),this.path=t,this.params=e}return t.prototype.toString=function(){return""+f(this.path)+(t=this.params,Object.keys(t).map((function(e){return";"+f(e)+"="+f(t[e])})).join(""));var t},t}();function f(t){return function(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}var v=function t(e){this.pathMatch="prefix",this.relative=!0,this.canDeactivate=[],this.canLoad=[],this.canActivate=[],this.canActivateChild=[],e&&(Object.assign(this,e),this.canDeactivate=e.canDeactivate?e.canDeactivate.map((function(t){return e=t,function(t,n){return h((function(){return e.canDeactivate(t,n)}))};var e})):[],this.canLoad=e.canLoad?e.canLoad.map((function(t){return e=t,function(t,n){return h((function(){return e.canLoad(t,n)}))};var e})):[],this.canActivate=e.canActivate?e.canActivate.map((function(t){return e=t,function(t){return h((function(){return e.canActivate(t)}))};var e})):[],this.canActivateChild=e.canActivateChild?e.canActivateChild.map((function(t){return e=t,function(t){return h((function(){return e.canActivateChild(t)}))};var e})):[]),this.children&&(this.children=this.children.map((function(e){return new t(e)})));var n=[];if("**"===this.path)n.push(new p(this.path)),this.matcher=new RegExp("^.*$");else{for(var i,r=["^(^../|./|//|/)?"],o=l(this.path.matchAll(/(^\.\.\/|\.\/|\/\/|\/)|([^:|\/]+)\/?|\:([^\/]+)\/?/g));!(i=o()).done;){var a=i.value,s=a[1],u=a[2],c=a[3];if(s)this.relative=!("//"===s||"/"===s);else if(u)r.push(u),n.push(new p(u));else if(c){r.push("(/[^/]+)");var f={};f[c]=null,n.push(new p("",f))}}"full"===this.pathMatch&&r.push("$");var v=r.join("");this.matcher=new RegExp(v)}this.segments=n};function d(t){return(Array.isArray(t)?t:[t]).join("/")}var m=function(){function t(t){this.pathMatch="prefix",this.relative=!0,this.data$=new n.ReplaySubject(1),this.params$=new n.ReplaySubject(1),this.queryParams$=new n.ReplaySubject(1),this.canDeactivate=[],this.canLoad=[],this.canActivate=[],this.canActivateChild=[],t&&Object.assign(this,t),this.data$.next(this.data),this.params$.next(this.params),this.queryParams$.next(this.queryParams)}return t.prototype.next=function(t){var e=this.data=Object.assign({},t.data);this.data$.next(e);var n=this.params=Object.assign({},t.params);this.params$.next(n);var i=this.queryParams=Object.assign({},t.queryParams);this.queryParams$.next(i)},t}(),b=function(t){t&&Object.assign(this,t),this.routerLink&&(this.url=Array.isArray(this.routerLink)?this.routerLink.join(""):this.routerLink)},y=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),g=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),w=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),x=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),k=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),A=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),j=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),$=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),L=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),O=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),C=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),R=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),S=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),U=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),P=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(b),I=function(){function i(){}return i.setRoutes=function(i){return this.routes=i.map((function(t){return new v(t)})),this.observe$=function(i,r,o){var a,u=n.merge(n.fromEvent(window,"popstate")).pipe(e.tap((function(t){console.log("location",document.location.pathname,"state",t.state)})),e.map((function(t){return new y({routerLink:document.location.pathname,trigger:"popstate"})})),e.shareReplay(1));return n.merge(u,o).pipe(e.switchMap((function(t){return t instanceof w&&t.route.canActivate&&t.route.canActivate.length?n.combineLatest.apply(void 0,t.route.canActivate.map((function(e){return e(t.route)}))).pipe(e.map((function(e){return e.reduce((function(t,e){return t&&e}),!0)?t:new U(s(s({},t),{},{reason:"Activation guard has dismissed navigation to route."}))}))):n.of(t)})),e.tap((function(e){if(e instanceof y){var n;console.log("NavigationStart",e.routerLink);var u,c=d(e.routerLink);0!==c.indexOf("/")&&a&&(null==(n=a.children)?void 0:n.length)?(u=a.children.reduce((function(t,e){return t||D(i,e,c)}),void 0))&&(a.childRoute=u,u=a):u=i.reduce((function(t,e){return t||D(i,e,c)}),void 0),null!=u?(a=u,o.next(new g(s(s({},e),{},{route:u})))):o.next(new P(s(s({},e),{},{error:new Error("unknown route")})))}else if(e instanceof g)o.next(new w(s({},e)));else if(e instanceof w)o.next(new x(s({},e)));else if(e instanceof x)o.next(new k(s({},e)));else if(e instanceof k)o.next(new A(s({},e)));else if(e instanceof A)o.next(new j(s({},e)));else if(e instanceof j)o.next(new $(s({},e)));else if(e instanceof $)o.next(new L(s({},e)));else if(e instanceof L)o.next(new O(s({},e)));else if(e instanceof O)o.next(new C(s({},e)));else if(e instanceof C)o.next(new R(s({},e)));else if(e instanceof R)o.next(new S(s({},e)));else if(e instanceof S){for(var l=[],h=e.route;null!=h;){var p,f;if(console.log(h.params,h.data),(null==(p=h.extractedUrl)?void 0:p.length)&&l.push(h.extractedUrl),h.childRoute)h=h.childRoute;else(null==(f=h.remainUrl)?void 0:f.length)&&(l[l.length-1]=l[l.length-1]+h.remainUrl),h=void 0}var v=l.join("/").replace(/\/\//g,"/");console.log("NavigationEnd",v),function(e,n,i){if(t.isPlatformBrowser&&window.history&&window.history.pushState){var r=document.title;e+=n?"?"+n.toString():"",i?window.history.replaceState(void 0,r,e):window.history.pushState(void 0,r,e)}}(v,void 0,"popstate"===e.trigger),r.next(e.route)}else e instanceof U?console.log("NavigationCancel",e):e instanceof P&&console.log("NavigationError",e)})),e.shareReplay(1))}(this.routes,this.route$,this.events$),this},i.setRouterLink=function(t,e){this.events$.next(new y({routerLink:t,trigger:"imperative"}))},i.navigate=function(t,e){this.events$.next(new y({routerLink:t,trigger:"imperative"}))},i}();function D(t,e,n){var i,r,o="",a=n,u=n.match(e.matcher);for(null!==u&&(o=u[0],a=n.substring(u[0].length,n.length),r=e);r&&r.redirectTo;)i=r.redirectTo,n=d(r.redirectTo),a=n,r=t.find((function(t){var e=n.match(t.matcher);return null!==e&&(o=e[0],a=n.substr(e[0].length,n.length),!0)}));if(r){var c=o.split("/").filter((function(t){return""!==t})),l={};r.segments.forEach((function(t,e){var n=Object.keys(t.params);n.length&&(l[n[0]]=c[e])}));var h=new m(s(s({},r),{},{initialUrl:n,urlAfterRedirects:i,extractedUrl:o,remainUrl:a,params:l}));return a.length&&e.children&&(h.childRoute=e.children.map((function(e){return D(t,e,a)})).find((function(t){return null!=t}))),h}}I.routes=[],I.route$=new n.ReplaySubject(1),I.events$=new n.ReplaySubject(1);var E=function(i){function o(){return i.apply(this,arguments)||this}u(o,i);var a=o.prototype;return a.getSegments=function(t){var e=[];return t.forEach((function(t){if("string"==typeof t)for(var n,i=[],r=l(t.matchAll(/([^:]+)|\:([^\/]+)/g));!(n=r()).done;){var o=n.value,a=o[1],s=o[2];if(a)i.push(a);else if(s){var u={};u[s]=null,i.push(u)}}else e.push(new p("",{}))})),e},a.onInit=function(){var i=this,r=t.getContext(this).node;n.fromEvent(r,"click").pipe(e.shareReplay(1)).pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){var e={skipLocationChange:i.skipLocationChange,replaceUrl:i.replaceUrl,state:i.state};return I.setRouterLink(i.routerLink,e),t.preventDefault(),!1}))},a.onChanges=function(){t.getContext(this).node.setAttribute("href",d(this.routerLink))},r(o,[{key:"routerLink",get:function(){return this.routerLink_},set:function(t){this.routerLink_=Array.isArray(t)?t:[t],this.segments=this.getSegments(this.routerLink_)}}]),o}(t.Directive);E.meta={selector:"[routerLink],[[routerLink]]",inputs:["routerLink"]};var _=function(n){function i(){return n.apply(this,arguments)||this}u(i,n);var o=i.prototype;return o.onInit=function(){var t=this;this.host||I.route$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){t.route=e,t.pushChanges()}))},o.onChanges=function(){this.host&&(this.route=this.host.route.childRoute)},r(i,[{key:"route",get:function(){return this.route_},set:function(t){this.route_&&t&&this.route_.component===t.component?this.route_.next(t):(this.route_=t,this.component=null==t?void 0:t.component)}},{key:"component",get:function(){return this.component_},set:function(e){var n=t.getContext(this),i=n.module,r=n.node;if(this.component_=e,this.element&&(this.element.parentNode.removeChild(this.element),i.remove(this.element,this),this.element=void 0,this.instance=void 0),e&&e.meta.template){var o=document.createElement("div");o.innerHTML=e.meta.template,1===o.children.length&&(o=o.firstElementChild),r.appendChild(o);var a=i.makeInstance(o,e,e.meta.selector,this);i.compile(o,a),this.instance=a,this.element=o}}}]),i}(t.Structure);_.first=!1,_.meta={selector:"router-outlet,[router-outlet]",hosts:{host:_}};var M=[_,E],q=[],N=function(t){function n(){var n;return n=t.call(this)||this,I.observe$.pipe(e.takeUntil(n.unsubscribe$)).subscribe(),I.navigate(window.location.pathname+window.location.search+window.location.hash),n}return u(n,t),n.forRoot=function(t){return I.setRoutes(t),n},n}(t.Module);N.meta={declarations:[].concat(M,q),exports:[].concat(M,q)};var T=function(n){function i(){var t;return(t=n.apply(this,arguments)||this).error=null,t}return u(i,n),i.prototype.onInit=function(){var n=this;t.getContext(this).node.classList.add("init"),t.errors$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){n.error=t,n.pushChanges()}))},i}(t.Component);T.meta={selector:"[app-component]"};var F=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n.prototype.onInit=function(){var t=this;this.host.route.data$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.title=e.title}))},n}(t.Component);F.meta={selector:"[contacts-component]",hosts:{host:_},template:'\n        <div class="page-contacts">\n            <div class="title">{{title}}</div>\n        </div>\n        '};var B=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n.prototype.onInit=function(){var t=this;this.host.route.data$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.title=e.title})),this.host.route.params$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.detailId=e.detailId}))},n}(t.Component);B.meta={selector:"[detail-component]",hosts:{host:_},template:'\n        <div class="page-detail">\n            <div class="title">Detail {{detailId}}</div>\n            <ul class="nav--menu">\n                <li><a routerLink="media" routerLinkActive="active">Media</a></li>\n                <li><a routerLink="files" routerLinkActive="active">Files</a></li>\n            </ul>\n            <router-outlet></router-outlet>\n        </div>\n        '};var H=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n.prototype.onInit=function(){var t=this;this.host.route.data$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.title=e.title}))},n}(t.Component);H.meta={selector:"[index-component]",hosts:{host:_},template:'\n        <div class="page-index">\n            <div class="title">{{title}}</div>\n        </div>\n        '};var z=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e.prototype.onInit=function(){},e}(t.Component);z.meta={selector:"[not-found-component]",template:'\n        <div class="page-not-found">\n            <div class="title">Not Found</div>\n        </div>\n        '};var G=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n.prototype.onInit=function(){var t=this;this.host.route.data$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.title=e.title}))},n}(t.Component);G.meta={selector:"[sub-component]",hosts:{host:_},template:'\n        <div class="page-sub">\n            <div class="title">{{title}}</div>\n        </div>\n        '};var J=function(){function t(){}var e=t.prototype;return e.canDeactivate=function(t,e){return!0},e.canLoad=function(t,e){return!0},e.canActivate=function(t){return console.log("canActivate",t),!1},e.canActivateChild=function(t){return!0},t}(),K=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e}(t.Module);K.meta={imports:[t.CoreModule,N.forRoot([{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"dashboard",component:H,data:{title:"Dashboard"}},{path:"detail/:detailId",component:B,data:{title:"Detail"},children:[{path:"media",component:G,data:{title:"Media"}},{path:"files",component:G,data:{title:"Files"}}]},{path:"contacts",component:F,data:{title:"Contacts"},canActivate:[new J]},{path:"**",component:z}])],declarations:[H,B,F],bootstrap:T},t.Browser.bootstrap(K)}(rxcomp,rxjs.operators,rxjs);
//# sourceMappingURL=main.min.js.map